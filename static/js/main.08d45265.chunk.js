(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{197:function(e,t,a){e.exports=a(447)},445:function(e,t,a){},447:function(e,t,a){"use strict";a.r(t);var n=a(83),r=a.n(n),o=a(32),c=a.n(o),l=a(463),i=a(464),s=a(1),u=a.n(s),m=a(87),h=a(19),d=a(61),p=a(36),g=a(192),f=a(193),E=a.n(f),v=a(194),b=a(37),w=a(196),O="LOAD_GEO_CACHE",y="UPDATE_GEO_CACHE",C="LIKE_GEO_CACHE",k="AUTH_USER",j="AUTH_ERROR",N="REG_ERROR",S="CLEAR_ERROR",A={geoCache:[],authenticated:"",errorMessage:[],regErrorMessage:""};var U=Object(p.c)({router:v.routerReducer,GeoCacheReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.geoCache,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return t.geoCache;case y:return Object(w.a)(e.filter(function(e){return e.id!=t.geoCacheDetails.id})).concat([Object.assign({},t.geoCacheDetails)]);case C:var a=Object(b.a)({},e);return Object.keys(a).map(function(e){return a[e].id!==t.id?a[e]:Object(b.a)({},a[e],{likes:Number(a[e].likes)+1})});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(b.a)({},e,{authenticated:t.loginData});case j:return Object(b.a)({},e,{errorMessage:t.errMsg});case N:return Object(b.a)({},e,{regErrorMessage:t.errMsg});case S:return Object(b.a)({},e,{regErrorMessage:"",errorMessage:""});default:return e}},toastr:o.reducer}),R=E()(),M=[g.a,Object(d.routerMiddleware)(R)],L=p.d.apply(void 0,[p.a.apply(void 0,M)].concat([])),I=Object(p.e)(Object(d.connectRouter)(R)(U),{},L,{auth:{authenticated:localStorage.getItem("authUser")}}),G=a(24),_=a(25),x=a(27),D=a(26),P=a(28),T=a(454),W=a(452),q=a(453),B=a(448),F=a(449),z=a(450),H=a(451),J=a(122),Y=a.n(J),Z=function(){var e=localStorage.getItem("authUser");if(e){var t=JSON.parse(e),a=Y()();return!Y()(1e3*t.created_at+1e3*t.expires_in).isBefore(a)||(localStorage.removeItem("authUser"),!1)}return!1},K=function(e){localStorage.setItem("authUser",JSON.stringify(e)),localStorage.setItem("token",e.access_token)},Q=function(){return localStorage.getItem("token")},X=function(){localStorage.removeItem("authUser"),localStorage.removeItem("token")},$=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).logout=function(e){e.preventDefault(),X(),a.props.history.push("/login")},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){var e=this.props.authenticated;return u.a.createElement("div",null,u.a.createElement(B.a,{color:"grey",light:!0,expand:"md"},u.a.createElement(F.a,{href:"/"},"Geo Location"),u.a.createElement(z.a,{className:"ml-auto",navbar:!0},u.a.createElement(H.a,null,u.a.createElement(W.a,{to:"/register/",className:"nav-link"},"Register")),e?u.a.createElement(s.Fragment,null,u.a.createElement(H.a,null,u.a.createElement(W.a,{to:"/map",className:"nav-link"},"Map")),u.a.createElement(H.a,null,u.a.createElement("a",{onClick:this.logout,className:"nav-link"},"Logout"))):u.a.createElement(H.a,null,u.a.createElement(W.a,{to:"/login/",className:"nav-link"},"Login")))))}}]),t}(s.Component);var V=Object(h.connect)(function(e){return{authenticated:Z()}})(Object(q.a)($)),ee=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).renderBody=function(){var e=a.props,t=e.authenticated,n=e.path,r=e.children;return t&&"/login"===n?u.a.createElement(T.a,{to:{pathname:"/"}}):t||"/login"===n?r:u.a.createElement(T.a,{to:{pathname:"/login"}})},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){var e=this.props.authenticated;return u.a.createElement("div",null,u.a.createElement(V,Object.assign({authenticated:e},this.props)),this.renderBody())}}]),t}(s.Component),te=Object(h.connect)(function(e){return{authenticated:Z(),path:e.router.location.pathname}})(ee),ae=a(52),ne=a(455),re=a(456),oe=a(457),ce=a(458),le=a(459),ie=a(460),se=a(461),ue=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",submitted:!1},a.handleChange=function(e){a.setState(Object(ae.a)({},e.target.name,e.target.value))},a.redirectToDashboard=function(){a.props.history.push("/")},a.doLogin=function(){a.setState({submitted:!0});var e=a.props.loggedInUser,t=a.state,n=t.email,r=t.password;n&&r&&e({email:n,password:r,redirect:a.redirectToDashboard})},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"componentWillUnmount",value:function(){(0,this.props.clearError)()}},{key:"render",value:function(){var e=this.props.errorMessage,t=this.state,a=t.email,n=t.password,r=t.submitted;return u.a.createElement(s.Fragment,null,u.a.createElement(V,Object.assign({authenticated:!1},this.props)),u.a.createElement(ne.a,null,u.a.createElement(re.a,{md:{size:6,offset:3}},u.a.createElement("div",{style:{color:"red"}},e||null," "),u.a.createElement(oe.a,null,u.a.createElement(ne.a,{form:!0},u.a.createElement(re.a,{md:12},u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"Email"),u.a.createElement(ie.a,{type:"email",name:"email",id:"exampleEmail",placeholder:"Enter Email",onChange:this.handleChange}),r&&!a&&u.a.createElement("div",{className:"help-block"},"Email is required")),u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"Password"),u.a.createElement(ie.a,{type:"password",name:"password",id:"Password",placeholder:"Enter Password",onChange:this.handleChange}),r&&!n&&u.a.createElement("div",{className:"help-block"},"Password is required")))),u.a.createElement(se.a,{onClick:this.doLogin},"Submit")))))}}]),t}(s.Component),me=a(53),he=a.n(me);function de(){return{type:S}}function pe(e){return function(t){return function(e){var t={grant_type:"password",email:e.email,password:e.password};return he.a.post("https://blooming-cove-35281.herokuapp.com/api/oauth/token",t,{crossdomain:!0}).then(function(e){return e.data}).catch(function(e){throw e})}({email:e.email,password:e.password}).then(function(a){K(a),t(function(e){return{type:k,loginData:e}}(a)),e.redirect()}).catch(function(e){t({type:j,errMsg:"Invalid Credentials"})})}}function ge(e){return function(t){return function(e){var t={user:{email:e.email,first_name:e.firstName,last_name:e.lastName,password:e.password,username:e.userName}};return he.a.post("https://blooming-cove-35281.herokuapp.com/api/users",t,{crossdomain:!0}).then(function(e){return e.data}).catch(function(e){throw e})}(e).then(function(a){o.toastr.success("Success","Successfully registered"),t({type:k,loginData:a}),e.redirect()}).catch(function(e){t({type:N,errMsg:{regErr:"Error! Email exists or input details is incorrect"}})})}}var fe=Object(h.connect)(function(e){return{errorMessage:e.auth.errorMessage}},function(e){return{loggedInUser:function(t){return e(pe(t))},clearError:function(){return e(de())}}})(ue),Ee=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).state={firstName:"",lastName:"",userName:"",email:"",password:"",submitted:!1},a.handleChange=function(e){a.setState(Object(ae.a)({},e.target.name,e.target.value))},a.redirectToLogin=function(){a.props.history.push("/login")},a.doRegister=function(){var e=a.props.registerUser,t=a.state,n=t.firstName,r=t.lastName,o=t.userName,c=t.email,l=t.password;a.setState({submitted:!0}),n&&r&&o&&c&&l&&e({firstName:n,lastName:r,userName:o,email:c,password:l,redirect:a.redirectToLogin})},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"componentWillUnmount",value:function(){(0,this.props.clearError)()}},{key:"render",value:function(){var e=this.state,t=e.firstName,a=e.lastName,n=e.userName,r=e.email,o=e.password,c=e.submitted,l=this.props.errorMessage;return u.a.createElement(s.Fragment,null,u.a.createElement(V,Object.assign({authenticated:!1},this.props)),u.a.createElement(ne.a,null,u.a.createElement(re.a,{md:{size:6,offset:3}},u.a.createElement("div",{style:{color:"red"}},l||null),u.a.createElement(oe.a,null,u.a.createElement(ne.a,{form:!0},u.a.createElement(re.a,{md:12},u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"First Name"),u.a.createElement(ie.a,{type:"text",name:"firstName",id:"FirstName",placeholder:"Enter First Name",onChange:this.handleChange}),c&&!t&&u.a.createElement("div",{className:"help-block",style:{color:"red"}},"First Name is required")),u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"Last Name"),u.a.createElement(ie.a,{type:"text",name:"lastName",id:"LastName",placeholder:"Enter Last Name",onChange:this.handleChange}),c&&!a&&u.a.createElement("div",{className:"help-block",style:{color:"red"}},"Last Name is required")),u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"User Name"),u.a.createElement(ie.a,{type:"text",name:"userName",id:"UserName",placeholder:"Enter User Name",onChange:this.handleChange}),c&&!n&&u.a.createElement("div",{className:"help-block",style:{color:"red"}},"User Name is required")),u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"Email"),u.a.createElement(ie.a,{type:"email",name:"email",id:"Email",placeholder:"Enter Email",onChange:this.handleChange}),c&&!r&&u.a.createElement("div",{className:"help-block",style:{color:"red"}},"Email is required")),u.a.createElement(ce.a,null,u.a.createElement(le.a,null,"Password"),u.a.createElement(ie.a,{type:"password",name:"password",id:"Password",placeholder:"Enter Password",onChange:this.handleChange}),c&&!o&&u.a.createElement("div",{className:"help-block",style:{color:"red"}},"Password is required")))),u.a.createElement(se.a,{onClick:this.doRegister},"Submit")))))}}]),t}(s.Component),ve=Object(h.connect)(function(e){return{errorMessage:e.auth.regErrorMessage.regErr||""}},function(e){return{registerUser:function(t){return e(ge(t))},clearError:function(){return e(de())}}})(Ee),be=(a(247),a(249),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function we(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Oe=a(462),ye=a(55),Ce=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).state={infoOpen:!1,i:null},a.onCloseInfo=function(){a.setState({index:null})},a.infoOpen=function(e){a.setState({index:e})},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.geoCache,n=t.likeGeoCache,r=this.state.index;return u.a.createElement(ye.GoogleMap,{defaultZoom:2,defaultCenter:{lat:-34.397,lng:150.644}},a.map(function(t,a){return u.a.createElement(ye.Marker,{key:a,position:{lat:Number(t.lat),lng:Number(t.lng)},onClick:function(){return e.infoOpen(a)}},r===a&&u.a.createElement(ye.InfoWindow,{onCloseClick:e.onCloseInfo},u.a.createElement("p",null,"".concat(t.lat,", ").concat(t.lng),u.a.createElement("br",null),u.a.createElement("button",{onClick:function(){return n(t.id)}},"Like"))))}))}}]),t}(s.Component),ke=Object(ye.withScriptjs)(Object(ye.withGoogleMap)(Ce)),je=(a(445),function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).updateGps=function(e){console.log(e),(0,a.props.updateGeoCache)(e)},a}return Object(P.a)(t,e),Object(_.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.loadGeoCache)()}},{key:"render",value:function(){var e=this.props,t=e.geoCache,a=e.likeGeoCache;return u.a.createElement("div",{className:"container-fluid mt-3 m-3"},u.a.createElement("div",{className:"row mb-3"},u.a.createElement(m.ActionCable,{channel:"GeoCacheChannel",room:1,onReceived:this.updateGps}),u.a.createElement(ke,{geoCache:t,likeGeoCache:a,googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3&libraries=geometry,drawing,places&&key=AIzaSyBnOC2cYnLyaaYXtnd_IEQWZLkqvg0tqoE",loadingElement:u.a.createElement("div",{style:{height:"50vh"}}),containerElement:u.a.createElement("div",{style:{height:"50vh",width:"100%"}}),mapElement:u.a.createElement("div",{style:{height:"50vh"}})})),u.a.createElement("div",{className:"row"},u.a.createElement(Oe.a,{responsive:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Cordinate"),u.a.createElement("th",null,"Title"),u.a.createElement("th",null,"Comment"),u.a.createElement("th",null,"Likes"),u.a.createElement("th",null,"Unlikes"),u.a.createElement("th",null,"Message"))),u.a.createElement("tbody",null,t.map(function(e,t){return u.a.createElement("tr",{key:t},u.a.createElement("td",null,"".concat(e.lat,", ").concat(e.lng)),u.a.createElement("td",null,e.title),u.a.createElement("td",null,e.comments),u.a.createElement("td",null,e.likes),u.a.createElement("td",null,e.unlikes),u.a.createElement("td",null,e.message))})))))}}]),t}(s.Component));function Ne(e){return function(t){return function(e){var t=Q();return he.a.post("https://blooming-cove-35281.herokuapp.com/api/geo_caches/".concat(e,"/like"),null,{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(t)},crossdomain:!0}).then(function(e){return e}).catch(function(e){throw e})}(e).then(function(){t(function(e){return{type:C,id:e}}(e)),o.toastr.success("Success","Like Successfully")}).catch(function(e){throw o.toastr.error("Error","Server Error occured"),e})}}function Se(){return function(e){return function(){var e=Q();return he.a.get("https://blooming-cove-35281.herokuapp.com/api/geo_caches",{headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(e)},crossdomain:!0}).then(function(e){return e.data}).catch(function(e){throw e})}().then(function(t){e(function(e){return{type:O,geoCache:e}}(t))}).catch(function(e){throw o.toastr.error("Error","Server Error occured"),e})}}var Ae=Object(h.connect)(function(e){return{geoCache:e.GeoCacheReducer}},function(e){return{loadGeoCache:function(){return e(Se())},loggedInUser:function(){return e(pe())},registerUser:function(){return e(ge())},updateGeoCache:function(t){return e({type:y,geoCacheDetails:t})},likeGeoCache:function(t){return e(Ne(t))}}})(je);r.a.render(u.a.createElement(h.Provider,{store:I},u.a.createElement(d.ConnectedRouter,{history:R},u.a.createElement(s.Fragment,null,u.a.createElement(c.a,{timeOut:4e3,newestOnTop:!1,preventDuplicates:!0,position:"top-right",transitionIn:"fadeIn",transitionOut:"fadeOut",progressBar:!0,closeOnToastrClick:!0}),u.a.createElement(l.a,null,u.a.createElement(i.a,{excat:!0,path:"/register",component:ve}),u.a.createElement(i.a,{excat:!0,path:"/login",component:fe}),u.a.createElement(te,null,u.a.createElement(m.ActionCableProvider,{url:"wss://blooming-cove-35281.herokuapp.com/cabel"},u.a.createElement(i.a,{excat:!0,path:"/",component:Ae}))))))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");be?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):we(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):we(t,e)})}}()}},[[197,2,1]]]);
//# sourceMappingURL=main.08d45265.chunk.js.map